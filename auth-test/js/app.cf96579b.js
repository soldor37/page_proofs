(function(t){function e(e){for(var r,o,i=e[0],u=e[1],c=e[2],d=0,p=[];d<i.length;d++)o=i[d],Object.prototype.hasOwnProperty.call(a,o)&&a[o]&&p.push(a[o][0]),a[o]=0;for(r in u)Object.prototype.hasOwnProperty.call(u,r)&&(t[r]=u[r]);l&&l(e);while(p.length)p.shift()();return n.push.apply(n,c||[]),s()}function s(){for(var t,e=0;e<n.length;e++){for(var s=n[e],r=!0,i=1;i<s.length;i++){var u=s[i];0!==a[u]&&(r=!1)}r&&(n.splice(e--,1),t=o(o.s=s[0]))}return t}var r={},a={app:0},n=[];function o(e){if(r[e])return r[e].exports;var s=r[e]={i:e,l:!1,exports:{}};return t[e].call(s.exports,s,s.exports,o),s.l=!0,s.exports}o.m=t,o.c=r,o.d=function(t,e,s){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},o.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(o.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)o.d(s,r,function(e){return t[e]}.bind(null,r));return s},o.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="/auth-test/";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],u=i.push.bind(i);i.push=e,i=i.slice();for(var c=0;c<i.length;c++)e(i[c]);var l=u;n.push([0,"chunk-vendors"]),s()})({0:function(t,e,s){t.exports=s("56d7")},"034f":function(t,e,s){"use strict";var r=s("85ec"),a=s.n(r);a.a},1505:function(t,e,s){},"193c":function(t,e,s){"use strict";var r=s("21e1"),a=s.n(r);a.a},"21e1":function(t,e,s){},"56d7":function(t,e,s){"use strict";s.r(e);s("45fc"),s("b0c0"),s("e260"),s("e6cf"),s("cca6"),s("a79d");var r=s("2b0e"),a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"app",attrs:{id:"app"}},[s("body",[s("div",{staticClass:"header-content"},[s("div",{staticClass:"header-title"},[t._v("Test assignment")]),s("div",{staticClass:"header__logout"},[t.isLoggedIn?s("button",{staticClass:"header__logout__btn",on:{click:function(e){return t.logout()}}},[t._v("Logout")]):t._e()])]),s("header",{staticClass:"header"}),s("content",{staticClass:"view-content"},[s("router-view")],1),s("footer",{staticClass:"footer-content"}),t._m(0)])])},n=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"footer-title"},[s("span",{staticClass:"footer-title__text"},[t._v("© 2020")])])}],o=(s("d3b7"),{data:function(){return{}},computed:{isLoggedIn:function(){return this.$store.getters.isLoggedIn}},methods:{logout:function(){var t=this;this.$store.dispatch("logout").then((function(){t.$router.push("/auth")}))}},created:function(){this.$http.interceptors.response.use(void 0,(function(t){return new Promise((function(){throw 401===t.status&&t.config&&!t.config.__isRetryRequest&&this.$store.dispatch("logout"),t}))}))}}),i=o,u=(s("034f"),s("2877")),c=Object(u["a"])(i,a,n,!1,null,null,null),l=c.exports,d=s("8c4f"),p=s("2f62"),m=s("bc3a"),h=s.n(m);r["a"].use(p["a"]);var f=new p["a"].Store({state:{status:"",token:localStorage.getItem("token")||"",user:{}},mutations:{auth_request:function(t){t.status="loading"},auth_success:function(t,e,s){t.status="success",t.token=e,t.user=s},auth_error:function(t){t.status="error"},logout:function(t){t.status="",t.token=""}},actions:{login:function(t,e){var s=t.commit;return new Promise((function(t,r){s("auth_request");var a={username:e.username,password:e.password};h.a.post("//emphasoft-test-assignment.herokuapp.com/api-token-auth/",a).then((function(r){var a=r.data.token;console.log(a),localStorage.setItem("token",a),s("auth_success",a,e),t(r)})).catch((function(t){s("auth_error"),localStorage.removeItem("token"),r(t)}))}))},logout:function(t){var e=t.commit;return new Promise((function(t){e("logout"),localStorage.removeItem("token"),delete h.a.defaults.headers.common["Authorization"],t()}))}},getters:{isLoggedIn:function(t){return!!t.token},authStatus:function(t){return t.status}}}),g=s("1dce"),v=s.n(g),_=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"auth"},[s("form",{staticClass:"window",on:{submit:function(e){return e.preventDefault(),t.submitAuth(e)}}},[s("span",{staticClass:"window__title"},[t._v("Authentification")]),s("div",{staticClass:"window__wrap-input",class:{"is-invalid":t.submitted&&t.$v.user.login.$error}},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.user.login,expression:"user.login"}],staticClass:"window__input",attrs:{type:"text",placeholder:"Login"},domProps:{value:t.user.login},on:{input:function(e){e.target.composing||t.$set(t.user,"login",e.target.value)}}})]),t.submitted&&!t.$v.user.login.required?s("div",{staticClass:"invalid-feedback"},[t.$v.user.login.required?t._e():s("span",[t._v("Login is required")]),t.$v.user.login.minLength?t._e():s("span",[t._v("Login must be at least 1 character")]),t.$v.user.login.maxLength?t._e():s("span",[t._v("Login must be maximum 150 characters long")])]):t._e(),s("div",{staticClass:"window__wrap-input",class:{"is-invalid":t.submitted&&t.$v.user.password.$error}},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.user.password,expression:"user.password"}],staticClass:"window__input",attrs:{type:"password",placeholder:"Password"},domProps:{value:t.user.password},on:{input:function(e){e.target.composing||t.$set(t.user,"password",e.target.value)}}})]),t.submitted&&!t.$v.user.password.required?s("div",{staticClass:"invalid-feedback"},[t.$v.user.password.required?t._e():s("span",[t._v("Password is required")]),t.$v.user.password.minLength?t._e():s("span",[t._v("Password must be at least 1 character")]),t.$v.user.password.maxLength?t._e():s("span",[t._v("Password must be maximum 128 characters long")])]):t._e(),t._m(0),t.wrongUserData?s("div",{staticClass:"invalid-feedback"},[s("span",[t._v("Wrong login and/or password")])]):t._e()])])},b=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"window__submit"},[s("button",{staticClass:"window__submit__btn",attrs:{type:"submit"}},[t._v("Submit")])])}],w=s("b5ae"),y={name:"auth",data:function(){return{user:{login:"",password:""},submitted:!1,wrongUserData:!1}},validations:{user:{login:{required:w["required"],minLength:Object(w["minLength"])(1),maxLength:Object(w["maxLength"])(150)},password:{required:w["required"],minLength:Object(w["minLength"])(1),maxLength:Object(w["maxLength"])(128)}}},methods:{submitAuth:function(){var t=this;if(this.submitted=!0,this.wrongUserData=!1,this.$v.$touch(),!this.$v.$invalid){var e=this.user.login,s=this.user.password;this.$store.dispatch("login",{username:e,password:s}).then((function(){return t.$router.push("/users")})).catch((function(e){t.wrongUserData=!0,console.log(e)}))}}}},C=y,$=(s("9509"),Object(u["a"])(C,_,b,!1,null,null,null)),L=$.exports,k=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"page"},[s("div",{staticClass:"users"},[s("div",{staticClass:"usersTable__toolbar"},[s("div",{staticClass:"usersTable__toolbar__title"},[t._v("Users")]),s("input",{directives:[{name:"model",rawName:"v-model",value:t.searchInput,expression:"searchInput"}],staticClass:"userTable__toolbar__search",attrs:{type:"text",placeholder:"Search for username.."},domProps:{value:t.searchInput},on:{keyup:function(e){return t.searchUser()},input:function(e){e.target.composing||(t.searchInput=e.target.value)}}})]),s("div",{staticClass:"usersTable__toolbar__sortBtn",on:{click:function(e){return t.sortTable(0)}}},[s("p",[t._v("Sort by ID")]),s("i",{staticClass:"arrow-up",attrs:{id:"arrow"}})]),s("table",{staticClass:"usersTable",attrs:{id:"usersTable"}},[s("thead",[s("tr",{staticClass:"usersTable__headers"},[s("th",{staticClass:"sorting",on:{click:function(e){return t.sortTable(0)}}},[t._v(" ID "),s("i",{staticClass:"arrow-up",attrs:{id:"arrow"}})]),s("th",[t._v("Username")]),s("th",[t._v("First name")]),s("th",[t._v("Last name")]),s("th",[t._v("Is active")]),s("th",[t._v("Last login")]),s("th",[t._v("Is superuser")])])]),s("tbody",{staticClass:"usersTable__data"},t._l(t.users,(function(e){return s("tr",{key:e.id},[s("td",[t._v(t._s(e.id))]),s("td",[t._v(t._s(e.username))]),s("td",[t._v(t._s(e.first_name))]),s("td",[t._v(t._s(e.last_name))]),s("td",[t._v(t._s(e.is_active))]),s("td",[t._v(t._s(e.last_login))]),s("td",[t._v(t._s(e.is_superuser))])])})),0)])])])},T=[],x=(s("c975"),s("a9e3"),{name:"users",data:function(){return{users:[],searchInput:""}},created:function(){this.getData()},methods:{getData:function(){this.getUsers()},sortTable:function(t){var e,s,r,a,n,o,i,u,c=0;e=document.getElementById("usersTable");var l=document.getElementsByClassName("arrow-up");r=!0,u="asc";while(r){for(r=!1,s=e.getElementsByTagName("tr"),a=1;a<s.length-1;a++)if(i=!1,n=s[a].getElementsByTagName("td")[t],o=s[a+1].getElementsByTagName("td")[t],"asc"==u){if(Number(n.innerHTML)>Number(o.innerHTML)){i=!0,l[0].style.transform="rotate(-135deg)",l[1].style.transform="rotate(-135deg)";break}}else if("desc"==u&&Number(n.innerHTML)<Number(o.innerHTML)){i=!0;break}i?(s[a].parentNode.insertBefore(s[a+1],s[a]),r=!0,c++):0==c&&"asc"==u&&(l[0].style.transform="rotate(45deg)",l[1].style.transform="rotate(45deg)",u="desc",r=!0)}},searchUser:function(){var t,e,s,r,a,n=this;for(t=n.searchInput.toUpperCase(),e=document.getElementById("usersTable"),s=e.getElementsByTagName("tr"),a=1;a<s.length;a++)r=s[a].getElementsByTagName("td")[1],r&&(r.innerHTML.toUpperCase().indexOf(t)>-1?s[a].style.display="":s[a].style.display="none")},getUsers:function(){var t=this;h.a.get("https://emphasoft-test-assignment.herokuapp.com/api/v1/users/",{headers:{Authorization:"Token "+localStorage.token}}).then((function(e){console.log(e),t.users=e.data})).catch((function(t){alert(t+"\n Ошибка подключения"),console.log("-----error-------"),console.log(t)}))}}}),I=x,O=(s("193c"),Object(u["a"])(I,k,T,!1,null,null,null)),P=O.exports;r["a"].config.productionTip=!1,r["a"].use(v.a),r["a"].use(d["a"]),r["a"].prototype.$http=h.a;var j=localStorage.getItem("token");j&&(r["a"].prototype.$http.defaults.headers.common["Authorization"]=j);var S=[{path:"/auth",component:L,name:"auth"},{path:"/users",component:P,name:"users",meta:{requiresAuth:!0}},{path:"*",redirect:"/users"}],q=new d["a"]({routes:S,mode:"history"});q.beforeEach((function(t,e,s){if(t.matched.some((function(t){return t.meta.requiresAuth}))){if(f.getters.isLoggedIn)return void s();s("/auth")}else f.getters.isLoggedIn&&"auth"==t.name?s("/users"):s()})),new r["a"]({router:q,store:f,render:function(t){return t(l)}}).$mount("#app")},"85ec":function(t,e,s){},9509:function(t,e,s){"use strict";var r=s("1505"),a=s.n(r);a.a}});
//# sourceMappingURL=app.cf96579b.js.map