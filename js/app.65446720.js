(function(t){function e(e){for(var n,o,i=e[0],u=e[1],c=e[2],d=0,p=[];d<i.length;d++)o=i[d],Object.prototype.hasOwnProperty.call(r,o)&&r[o]&&p.push(r[o][0]),r[o]=0;for(n in u)Object.prototype.hasOwnProperty.call(u,n)&&(t[n]=u[n]);l&&l(e);while(p.length)p.shift()();return a.push.apply(a,c||[]),s()}function s(){for(var t,e=0;e<a.length;e++){for(var s=a[e],n=!0,i=1;i<s.length;i++){var u=s[i];0!==r[u]&&(n=!1)}n&&(a.splice(e--,1),t=o(o.s=s[0]))}return t}var n={},r={app:0},a=[];function o(e){if(n[e])return n[e].exports;var s=n[e]={i:e,l:!1,exports:{}};return t[e].call(s.exports,s,s.exports,o),s.l=!0,s.exports}o.m=t,o.c=n,o.d=function(t,e,s){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},o.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(o.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)o.d(s,n,function(e){return t[e]}.bind(null,n));return s},o.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="/";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],u=i.push.bind(i);i.push=e,i=i.slice();for(var c=0;c<i.length;c++)e(i[c]);var l=u;a.push([0,"chunk-vendors"]),s()})({0:function(t,e,s){t.exports=s("56d7")},"034f":function(t,e,s){"use strict";var n=s("85ec"),r=s.n(n);r.a},1505:function(t,e,s){},"193c":function(t,e,s){"use strict";var n=s("21e1"),r=s.n(n);r.a},"21e1":function(t,e,s){},"56d7":function(t,e,s){"use strict";s.r(e);s("45fc"),s("b0c0"),s("e260"),s("e6cf"),s("cca6"),s("a79d");var n=s("2b0e"),r=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"app",attrs:{id:"app"}},[s("body",[s("div",{staticClass:"header-content"},[s("div",{staticClass:"header-title"},[t._v("Test assignment")]),s("div",{staticClass:"header__logout"},[t.isLoggedIn?s("button",{staticClass:"header__logout__btn",on:{click:function(e){return t.logout()}}},[t._v("Logout")]):t._e()])]),s("header",{staticClass:"header"}),s("content",{staticClass:"view-content"},[s("router-view")],1),s("footer",{staticClass:"footer-content"}),t._m(0)])])},a=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"footer-title"},[s("span",{staticClass:"footer-title__text"},[t._v("© 2020")])])}],o=(s("d3b7"),{data:function(){return{}},computed:{isLoggedIn:function(){return this.$store.getters.isLoggedIn}},methods:{logout:function(){var t=this;this.$store.dispatch("logout").then((function(){t.$router.push("/auth")}))}},created:function(){this.$http.interceptors.response.use(void 0,(function(t){return new Promise((function(){throw 401===t.status&&t.config&&!t.config.__isRetryRequest&&this.$store.dispatch("logout"),t}))}))}}),i=o,u=(s("034f"),s("2877")),c=Object(u["a"])(i,r,a,!1,null,null,null),l=c.exports,d=s("8c4f"),p=s("2f62"),h=s("bc3a"),m=s.n(h);n["a"].use(p["a"]);var f=new p["a"].Store({state:{status:"",token:localStorage.getItem("token")||"",user:{}},mutations:{auth_request:function(t){t.status="loading"},auth_success:function(t,e,s){t.status="success",t.token=e,t.user=s},auth_error:function(t){t.status="error"},logout:function(t){t.status="",t.token=""}},actions:{login:function(t,e){var s=t.commit;return new Promise((function(t,n){s("auth_request");var r={username:e.username,password:e.password};m.a.post("//emphasoft-test-assignment.herokuapp.com/api-token-auth/",r).then((function(n){var r=n.data.token;console.log(r),localStorage.setItem("token",r),s("auth_success",r,e),t(n)})).catch((function(t){s("auth_error"),localStorage.removeItem("token"),n(t)}))}))},logout:function(t){var e=t.commit;return new Promise((function(t){e("logout"),localStorage.removeItem("token"),delete m.a.defaults.headers.common["Authorization"],t()}))}},getters:{isLoggedIn:function(t){return!!t.token},authStatus:function(t){return t.status}}}),v=s("1dce"),g=s.n(v),_=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"auth"},[s("form",{staticClass:"window",on:{submit:function(e){return e.preventDefault(),t.submitAuth(e)}}},[s("span",{staticClass:"window__title"},[t._v("Authentification")]),s("div",{staticClass:"window__wrap-input",class:{"is-invalid":t.submitted&&t.$v.user.login.$error}},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.user.login,expression:"user.login"}],staticClass:"window__input",attrs:{type:"text",placeholder:"Login"},domProps:{value:t.user.login},on:{input:function(e){e.target.composing||t.$set(t.user,"login",e.target.value)}}})]),t.submitted&&!t.$v.user.login.required?s("div",{staticClass:"invalid-feedback"},[t.$v.user.login.required?t._e():s("span",[t._v("Login is required")]),t.$v.user.login.minLength?t._e():s("span",[t._v("Login must be at least 1 character")]),t.$v.user.login.maxLength?t._e():s("span",[t._v("Login must be maximum 150 characters long")])]):t._e(),s("div",{staticClass:"window__wrap-input",class:{"is-invalid":t.submitted&&t.$v.user.password.$error}},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.user.password,expression:"user.password"}],staticClass:"window__input",attrs:{type:"password",placeholder:"Password"},domProps:{value:t.user.password},on:{input:function(e){e.target.composing||t.$set(t.user,"password",e.target.value)}}})]),t.submitted&&!t.$v.user.password.required?s("div",{staticClass:"invalid-feedback"},[t.$v.user.password.required?t._e():s("span",[t._v("Password is required")]),t.$v.user.password.minLength?t._e():s("span",[t._v("Password must be at least 1 character")]),t.$v.user.password.maxLength?t._e():s("span",[t._v("Password must be maximum 128 characters long")])]):t._e(),t._m(0),t.wrongUserData?s("div",{staticClass:"invalid-feedback"},[s("span",[t._v("Wrong login and/or password")])]):t._e()])])},b=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"window__submit"},[s("button",{staticClass:"window__submit__btn",attrs:{type:"submit"}},[t._v("Submit")])])}],w=s("b5ae"),y={name:"auth",data:function(){return{user:{login:"",password:""},submitted:!1,wrongUserData:!1}},validations:{user:{login:{required:w["required"],minLength:Object(w["minLength"])(1),maxLength:Object(w["maxLength"])(150)},password:{required:w["required"],minLength:Object(w["minLength"])(1),maxLength:Object(w["maxLength"])(128)}}},methods:{submitAuth:function(){var t=this;if(this.submitted=!0,this.wrongUserData=!1,this.$v.$touch(),!this.$v.$invalid){var e=this.user.login,s=this.user.password;this.$store.dispatch("login",{username:e,password:s}).then((function(){return t.$router.push("/users")})).catch((function(e){t.wrongUserData=!0,console.log(e)}))}}}},C=y,$=(s("9509"),Object(u["a"])(C,_,b,!1,null,null,null)),L=$.exports,k=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"page"},[s("div",{staticClass:"users"},[s("div",{staticClass:"usersTable__toolbar"},[s("div",{staticClass:"usersTable__toolbar__title"},[t._v("Users")]),s("input",{directives:[{name:"model",rawName:"v-model",value:t.searchInput,expression:"searchInput"}],staticClass:"userTable__toolbar__search",attrs:{type:"text",placeholder:"Search for username.."},domProps:{value:t.searchInput},on:{keyup:function(e){return t.searchUser()},input:function(e){e.target.composing||(t.searchInput=e.target.value)}}})]),s("div",{staticClass:"usersTable__toolbar__sortBtn",on:{click:function(e){return t.sortTable(0)}}},[t._v("Sort by ID")]),s("table",{staticClass:"usersTable",attrs:{id:"usersTable"}},[s("thead",[s("tr",{staticClass:"usersTable__headers"},[s("th",{on:{click:function(e){return t.sortTable(0)}}},[t._v(" ID "),s("i",{staticClass:"arrow"})]),s("th",[t._v("Username")]),s("th",[t._v("First name")]),s("th",[t._v("Last name")]),s("th",[t._v("Is active")]),s("th",[t._v("Last login")]),s("th",[t._v("Is superuser")])])]),s("tbody",{staticClass:"usersTable__data"},t._l(t.users,(function(e){return s("tr",{key:e.id},[s("td",[t._v(t._s(e.id))]),s("td",[t._v(t._s(e.username))]),s("td",[t._v(t._s(e.first_name))]),s("td",[t._v(t._s(e.last_name))]),s("td",[t._v(t._s(e.is_active))]),s("td",[t._v(t._s(e.last_login))]),s("td",[t._v(t._s(e.is_superuser))])])})),0)])])])},T=[],x=(s("c975"),s("a9e3"),{name:"users",data:function(){return{users:[],searchInput:""}},created:function(){this.getData()},methods:{getData:function(){this.getUsers()},sortTable:function(t){var e,s,n,r,a,o,i,u,c=0;e=document.getElementById("usersTable"),n=!0,u="asc";while(n){for(n=!1,s=e.getElementsByTagName("tr"),r=1;r<s.length-1;r++)if(i=!1,a=s[r].getElementsByTagName("td")[t],o=s[r+1].getElementsByTagName("td")[t],"asc"==u){if(Number(a.innerHTML)>Number(o.innerHTML)){i=!0;break}}else if("desc"==u&&Number(a.innerHTML)<Number(o.innerHTML)){i=!0;break}i?(s[r].parentNode.insertBefore(s[r+1],s[r]),n=!0,c++):0==c&&"asc"==u&&(u="desc",n=!0)}},searchUser:function(){var t,e,s,n,r,a=this;for(t=a.searchInput.toUpperCase(),e=document.getElementById("usersTable"),s=e.getElementsByTagName("tr"),r=1;r<s.length;r++)n=s[r].getElementsByTagName("td")[1],n&&(n.innerHTML.toUpperCase().indexOf(t)>-1?s[r].style.display="":s[r].style.display="none")},getUsers:function(){var t=this;m.a.get("http://emphasoft-test-assignment.herokuapp.com/api/v1/users/",{headers:{Authorization:"Token "+localStorage.token}}).then((function(e){console.log(e),t.users=e.data})).catch((function(t){alert(t+"\n Ошибка подключения"),console.log("-----error-------"),console.log(t)}))}}}),I=x,O=(s("193c"),Object(u["a"])(I,k,T,!1,null,null,null)),P=O.exports;n["a"].config.productionTip=!1,n["a"].use(g.a),n["a"].use(d["a"]),n["a"].prototype.$http=m.a;var j=localStorage.getItem("token");j&&(n["a"].prototype.$http.defaults.headers.common["Authorization"]=j);var S=[{path:"/auth",component:L,name:"auth"},{path:"/users",component:P,name:"users",meta:{requiresAuth:!0}},{path:"*",redirect:"/users"}],q=new d["a"]({routes:S,mode:"history"});q.beforeEach((function(t,e,s){if(t.matched.some((function(t){return t.meta.requiresAuth}))){if(f.getters.isLoggedIn)return void s();s("/auth")}else f.getters.isLoggedIn&&"auth"==t.name?s("/users"):s()})),new n["a"]({router:q,store:f,render:function(t){return t(l)}}).$mount("#app")},"85ec":function(t,e,s){},9509:function(t,e,s){"use strict";var n=s("1505"),r=s.n(n);r.a}});
//# sourceMappingURL=app.65446720.js.map